{#
# Copyright (C) 2016-2021 Cinc
#
# All rights reserved.
#
# License: 3-clause BSD
#}
## extends 'layout.html'
<!DOCTYPE html>
<html lang="${trac_lang}">
  <!--! Add site-specific style sheet -->
  <head>
    # block head
          # endblock head

      <!--! Set the viewport so responsive feature works on mobile devices -->
      <meta name="viewport" content="width=device-width, initial-scale=1" />
      <link rel="stylesheet" type="text/css"
          href="${href.chrome('blueflat/css/bootstrap.min.css')}" />
      <!-- Optional theme -->
      <link rel="stylesheet" type="text/css"
            href="${req.base_path}/chrome/blueflat/css/bootstrap-flat.css" />

      <link rel="stylesheet" type="text/css"
            href="${req.base_path}/chrome/blueflat/css/blueflat.css" />
      <script src="${href.chrome('theme/js/bootstrap.min.js')}"></script>

      <script type="text/javascript">
        // Avoid `console` errors in browsers that lack a console.
        (function() {
            var method;
            var noop = function () {};
            var methods = [
                'assert', 'clear', 'count', 'debug', 'dir', 'dirxml', 'error',
                'exception', 'group', 'groupCollapsed', 'groupEnd', 'info', 'log',
                'markTimeline', 'profile', 'profileEnd', 'table', 'time', 'timeEnd',
                'timeStamp', 'trace', 'warn'
            ];
            var length = methods.length;
            var console = (window.console = window.console || {});

            while (length--) {
                method = methods[length];

                // Only stub undefined methods.
                if (!console[method]) {
                    console[method] = noop;
                }
            }
        }());
    </script>
  </head>

    <body>
    # block body

    #   include 'site_header.html' ignore missing

            <!--! Top navigation -->
            <div class="navbar navbar-default" id="navbar-fixed-top">
             <div class="container-fluid">
                <div class="navbar-header">
                  <a class="navbar-toggle collapsed navbar-btn" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                  </a>
                  <a class="navbar-brand" href="${req.base_url}">${project.name}</a>
                </div>

                 <div class="collapse navbar-collapse">
                  <div class="btn-group pull-right" id="metanav">
                    <div class="btn dropdown-toggle" data-toggle="dropdown" href="#">
                      ${chrome['nav']['metanav'][0]['label']}
                      <span class="caret"></span>
                    </div>
                      # if chrome.nav['metanav']:
                    <ul class="dropdown-menu">
                        # with
                        # if chrome['nav']['metanav'][1]['name'] == 'logout':
                        #   set start = 1
                        # else:
                        #   set start = 0
                        # endif
                        # for item in chrome.nav['metanav'][start:]:
                        <li class="">${item.label}</li>
                        # endfor
                        # endwith
                    {#
                      <li py:for="idx, item in  enumerate(chrome.nav['metanav'])"
                          class="${classes(first_last(idx, chrome.nav['metanav']), active=item.active)}">${item.label}</li>
                    #}
                    </ul>
                      # endif
                  </div>

                  <div >
                    # if chrome.nav['mainnav']:
                      <ul class="nav navbar-nav">
                          # for item in chrome.nav['mainnav']:
                          <li class="">${item.label}
                          </li>
                          # endfor
                          {#
                      <li py:for="idx, item in enumerate(chrome.nav['mainnav'])"
                          class="${classes(first_last(idx, chrome.nav['mainnav']), active=item.active)}">${item.label}
                      </li>
                          #}
                      <li>
                        <form id="search" class="navbar-search pull-left" action="${href.search()}" method="get">
                            # if not trac_error_rendering and 'SEARCH_VIEW' in perm:
                            <input type="text" class="search-query span2" placeholder="Quick search" id="proj-search" name="q" size="18" accesskey="f" value=""/>
                            # endif
                        </form>
                      </li>
                    </ul>
                      # endif
                  </div> <!-- /.nav-collapse -->

                </div>

              </div> <!-- /navbar-inner -->
            </div>


    <div id="main"
         ${{'class': {
         'container': True,
         'uisymbols': req.session.get('ui.use_symbols'),
         'uinohelp': req.session.get('ui.hide_help'),
         }}|htmlattr}>

    # if resourcepath_template:
      #   include resourcepath_template ignore missing
      # endif
      <div id="ctxtnav" class="btn-group pull-right">
        # if chrome.ctxtnav:
        <ul>
          # for elm in chrome.ctxtnav:
              ## if elm is string:
              ##    set elm = ''
              ## else:
              ##   set elm = elm(role="button")
              ## endif

          <li ${{'class': {'first': loop.first, 'last': loop.last}}|htmlattr}>${
            elm}</li>


            ##${elm}
          # endfor
        </ul>
        # endif
      </div>



      ${jmacros.warnings(chrome.warnings)}

      ${jmacros.notices(chrome.notices)}

    <div class="row">
    # block content

    # endblock content


{#

          <div id="ctxtnav" class="btn-group pull-right" py:if="chrome.ctxtnav">
              <py:choose test="1">
                <py:when test="req.environ['PATH_INFO'].startswith('/wiki')" py:with="path = req.environ['PATH_INFO'][6:]">
                    <!--! Add edit button to top of wiki pages -->
                    <a py:if="'WIKI_MODIFY' in req.perm('wiki', path)" href="${req.href(req.path_info)}?action=edit">
                        Edit page
                    </a>
                    <py:for each="i, elm in enumerate(chrome.ctxtnav)">${elm(role="button")}</py:for>
                </py:when>

                <py:when test="req.environ['PATH_INFO'].startswith('/ticket')">
                    <py:for each="i, elm in enumerate(chrome.ctxtnav)">

                    <?python
                       if not isinstance(elm, basestring):
                         c=elm.attrib.get('class')
                         if c and 'missing' in c:
                           elm(role="button", class_="disabled")
                         else:
                           elm(role="button")
                       else:
                         elm=''
                    ?>
                    $elm
                    </py:for>
                </py:when>

              <py:otherwise>
                  <py:for each="i, elm in enumerate(chrome.ctxtnav)">
                    <?python
                       if not isinstance(elm, basestring):
                         elm(role="button")
                       else:
                         elm=''
                    ?>
                    $elm
                  </py:for>
              </py:otherwise>
              </py:choose>
          </div>

#}
      </div>
    </div>

    <div id="footer"><hr/>
      <a id="tracpowered" href="https://trac.edgewall.org/"
         ><img src="${chrome.htdocs_location}trac_logo_mini.png" height="30"
               width="107" alt="${_('Trac Powered')}"/></a>
      <p class="left">
        # set trac_version
        <a href="${href.about()}"><strong>Trac ${trac.version}</strong></a>
        <br />
        # endset
        # set eo
        <a href="http://www.edgewall.org/">Edgewall Software</a>
        # endset
        # trans trac_version, eo

        Powered by ${trac_version}
        By ${eo}.

        # endtrans
      </p>
      <p class="right">${chrome.footer}</p>
    </div>

    <!-- Put script at the end for faster loading. -->
    # include 'site_footer.html' ignore missing
    # endblock body
  </body>
</html>
