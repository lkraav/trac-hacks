{#
# Copyright (C) 2021 Cinc
#
# All rights reserved.
#
# License: 3-clause BSD
#}
# extends 'layout.html'
<!DOCTYPE html>
<html>
    <head>
        <title>
            # block title
            Search Code Reviews
            ${ super() }
            # endblock title
        </title>
        # block head
        ${ super() }
        # endblock head
    </head>
    <body>
    # block content
        <div id="content" class="trac-content borderless">
            <h1>Code Review Search</h1>
            <form id="searchReview" action="${href.peerReviewSearch()}" method="get">
                <fieldset>
                    <div>
                        <label>Code Review Name:
                          <input id="name" name="CodeReviewName" size="25" value="" type="text" />
                        </label>
                    </div>
                    <div>
                        <label>Reviews after date -
                            <select size="1" name="DateMonth" id="Month"
                                    onchange="resetDays(document.getElementById('Month').options[document.getElementById('Month').selectedIndex].value,
                                    document.getElementById('Year').options[document.getElementById('Year').selectedIndex].value)">
                                <option value="0">Select...</option>
                                <option value="01">January</option>
                                <option value="02">February</option>
                                <option value="03">March</option>
                                <option value="04">April</option>
                                <option value="05">May</option>
                                <option value="06">June</option>
                                <option value="07">July</option>
                                <option value="08">August</option>
                                <option value="09">September</option>
                                <option value="10">October</option>
                                <option value="11">November</option>
                                <option value="12">December</option>
                            </select>
                            <span id="DaySpan">
                                <select size="1" name="DateDay1" id="Day" onchange="setDateIndex();">
                                    <option value="0" selected="selected">Select...</option>
                                </select>
                            </span>
                            <select size="1" name="DateYear" id="Year"
                                    onchange="resetDays(document.getElementById('Month').options[document.getElementById('Month').selectedIndex].value,
                                    document.getElementById('Year').options[document.getElementById('Year').selectedIndex].value)">
                                <option selected="selected" value="0">Select...</option>
                                # for item in years:
                                <option value="${item}">${item}</option>
                                # endfor
                            </select>
                        </label>
                    </div>

                    <div>
                        <label>
                            Status -
                            <select size="1" name="Status" id="status">
                                <option value="Select...">Select...</option>
                                <option value="new">Open for review (new)</option>
                                <option value="reviewed">Reviewed</option>
                                <option value="approved">Approved</option>
                                <option value="disapproved">Disapproved</option>
                                <option value="Closed">Closed (obsolete)</option>
                            </select>
                        </label>
                    </div>

                    <div>
                        <label>
                            Author -
                            <select size="1" name="Author" id="author">
                                <option>Select...</option>
                                # for item in users:
                                <option value="${item}">${authorinfo(item)}</option>
                                # endfor
                            </select>
                        </label>
                    </div>

                    <div class="buttons">
                        <input type="hidden" name="doSearch" value="yes" />
                        ## used by javascript to get the current day selected
                        <input type="hidden" name="DateDay" value="0" id="dayHolder" />
                        <input value="Search" type="submit" />
                    </div>
                </fieldset>
            </form>
            # if doSearch == 'yes':
                <h2>Search Results</h2>
                <table class="listing" id="myreviewlist">
                    <thead>
                        <tr>
                            <th>Review</th>
                            <th>Author</th>
                            <th>Status</th>
                            <th>Name</th>
                            <th>Date Opened</th>
                            <th>Date Finished</th>
                        </tr>
                    </thead>
                    <tbody id = "myfilebody">
                    # for item in results:
                        # if item[2] == '':
                        <tr>
                            <td>${item[0]}</td>
                            <td>${authorinfo(item[1])}</td>
                            <td>${item[2]}</td>
                            <td>${item[4]}</td>
                            <td>${item[3]}</td>
                            <td>${item[5]}</td>
                        </tr>
                        # else:
                        <tr class="${loop.cycle('even', 'odd')}">
                            <td><a href="${href.peerreviewview(item[0])}">${item[0]}</a></td>
                            <td><a href="${href.peerreviewview(item[0])}">${authorinfo(item[1])}</a></td>
                            <td><a href="${href.peerreviewview(item[0])}">${item[2]}</a></td>
                            <td><a href="${href.peerreviewview(item[0])}">${item[4]}</a></td>
                            <td><a href="${href.peerreviewview(item[0])}">${item[3]}</a></td>
                            <td><a href="${href.peerreviewview(item[0])}">${item[5]}</a></td>
                        </tr>
                        # endif
                    # endfor
                    </tbody>
                </table>

            # endif
        </div>
    # endblock content
    </body>
</html>
