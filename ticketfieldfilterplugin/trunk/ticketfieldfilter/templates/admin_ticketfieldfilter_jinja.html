{#
# Copyright (C) 2021 Cinc
#
# All rights reserved.
#
# License: 3-clause BSD
#}
# extends 'admin.html'
<!DOCTYPE html>
<html>
    <head>
        <title>
          # block admintitle
          ${_("Ticket Fields")}
          # endblock admintitle
        </title>
        # block head
        ${ super() }
        # endblock head
    </head>
    <body>
        # block adminpanel
        <h2>${_("Ticket Fields Setup")}</h2>
        <div id="content">
            <p>${_("Select ticket fields to be shown depending on ticket type.")}</p>
            # for type in sorted(tkt_fields):
            <form action="" id="${type}_form" method="post" class="field-form">
                ${jmacros.form_token_input()}
                <fieldset>
                    <input type="hidden" name="type" value="${type}"/>
                    <legend>${type}</legend>
                    <div class="field">
                        <table class="listing">
                            <thead>
                            <tr>
                                <th></th>
                                <th>${_("Ticket fields")}</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td>${_("Enabled fields")}</td>
                                <td>
                                    # for key, val in all_fields:
                                    <label class="field_label">
                                        <input name="sel" value="${key}" type="checkbox"
                                               ${{"checked": key in tkt_fields[type]}|htmlattr}/>
                                        <span title="${val}">${val}</span>
                                    </label>
                                    # endfor
                                </td>
                            </tr>
                            <tr>
                                <td>${_("Read only fields")}</td>
                                <td>
                                    # for key, val in all_fields:
                                    <label class="field_label">
                                        <input name="readonly" value="${key}" type="checkbox"
                                               ${{"checked": key in tkt_readonly[type]}|htmlattr}/>
                                        <span title="${val}" class="${'missing' if key not in tkt_fields[type] else None}">${val}</span>
                                    </label>
                                    # endfor
                                </td>
                            </tr>
                            </tbody>
                        </table>
                        <p class="help">When a field is marked as read only, it will only be shown in the ticket header but not
                        in the <strong>Modify</strong> section. Disabled fields are not shown at all.</p>
                    </div>
                    <div class="field">
                        <input name="permissions" value="${_('Permissions')}" id="${type}_permissions" type="submit"/>
                        <input name="save" value="${_('Save')}" id="${type}_save" type="submit"/>
                    </div>
                </fieldset>
            </form>
            # endfor
        </div>
        # endblock
    </body>
</html>
