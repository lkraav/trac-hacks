<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:xi="http://www.w3.org/2001/XInclude"
      xmlns:py="http://genshi.edgewall.org/"
      xmlns:i18n="http://genshi.edgewall.org/i18n">
  <xi:include href="admin.html" />
  <head>
    <title>Ticket Team Dispatcher</title>
  </head>

  <body>
    <h2>Manage Ticket Teams</h2>

    <form id="notifications" class="addnew" method="post" action="">
      <fieldset>
        <legend>Edit Notification Settings:</legend>
        Notify on:
        <div class="field">
          <label>
            <input type="checkbox" name="notify_on_create" checked="${notify_on_create or None}" />
            ticket creation
          </label>
        </div>
        <div class="field">
          <label>
            <input type="checkbox" name="notify_on_change" checked="${notify_on_change or None}" />
            ticket change
          </label>
        </div>
        <div class="field">
          <label>
            <input type="checkbox" name="notify_on_delete" checked="${notify_on_delete or None}" />
            ticket deletion
          </label>
        </div>
        <div class="buttons">
          <input type="hidden" name="action" value="notify" />
          <input type="submit" value="${_('Save')}" />
        </div>
      </fieldset>
    </form>

    <form id="modcaption" class="addnew" method="post" action="">
      <fieldset>
        <legend>Edit Caption:</legend>
        <label>Name:
          <input type="text" name="caption" value="$caption" />
        </label>
        <div class="buttons">
          <input type="hidden" name="action" value="rename" />
          <input type="submit" value="${_('Save')}" />
        </div>
      </fieldset>
    </form>

    <form id="addteam" class="addnew" method="post" action="">
      <fieldset>
        <legend>Add Team:</legend>
        <div class="field">
          <label>Name:
            <input type="text" name="team" />
          </label>
        </div>
        <div class="buttons">
          <input type="hidden" name="action" value="addteam" />
          <input type="submit" value="${_('Add')}" />
        </div>
      </fieldset>
    </form>

    <form id="addsubject" class="addnew" method="post" action="">
      <fieldset>
        <legend>Add Subject to Team:</legend>
        <div class="field">
          <label>Subject:
            <select id="subject" name="subject">
              <option py:for="user in sorted(users, key=lambda u: u.username)">$user.username</option>
            </select>
          </label>
        </div>
        <div class="field">
          <label>Subject:
            <select id="team" name="team">
              <option py:for="team in sorted(teams)">$team</option>
            </select>
          </label>
        </div>
        <div class="buttons">
          <input type="hidden" name="action" value="addtoteam" />
          <input type="submit" name="save" value="${_('Add')}" />
        </div>
      </fieldset>
    </form>

    <h3>Team Membership</h3>
    <form method="post" action="">
      <table id="grouplist" class="listing">
        <thead>
          <tr><th>Team</th><th>Subject</th></tr>
        </thead>
        <tbody>
          <tr py:for="team in sorted(teams)">
            <td>
              <label>
                <input type="checkbox" name="sel"
                       value="${team}"/> $team
              </label>
            </td>
            <td>
              <label py:for="user in sorted(users, key=lambda u: u.username)" py:if="user[team] == '1'">
                <input type="checkbox" name="sel"
                       value="${'%s:%s' % (user.username, team)}"/> $user.username
              </label>
            </td>
          </tr>
        </tbody>
      </table>

      <div class="buttons">
        <input type="hidden" name="action" value="remove" />
        <input type="submit" id="remove" value="${_('Remove selected items')}" />
      </div>
    </form>
  </body>

</html>
