<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:py="http://genshi.edgewall.org/"
      xmlns:xi="http://www.w3.org/2001/XInclude">
  <xi:include href="layout.html" />
  <xi:include href="macros.html" />
  <head>

	<style type="text/css">
	#chart { height: 500px }
	</style>
	
	<script type="text/javascript" src="http://yui.yahooapis.com/2.5.2/build/yahoo-dom-event/yahoo-dom-event.js"></script>
	<script type="text/javascript" src="http://yui.yahooapis.com/2.5.2/build/element/element-beta-min.js"></script>
	<script type="text/javascript" src="http://yui.yahooapis.com/2.5.2/build/datasource/datasource-beta-min.js"></script>
	<script type="text/javascript" src="http://yui.yahooapis.com/2.5.2/build/json/json-min.js"></script>
	<!-- OPTIONAL: Connection (enables XHR) -->
	<script type="text/javascript" src="http://yui.yahooapis.com/2.5.2/build/connection/connection-min.js"></script>
	<!-- Source files -->
	<script type="text/javascript" src="http://yui.yahooapis.com/2.5.2/build/charts/charts-experimental-min.js"></script>
  </head>
<body>
<p/>
<span class="chart_title">
	<h1>Ticket Statistics</h1>
</span>
<div id="content">
<div id="chart"></div>
<form action="" method="post" id="dt_frm">
	<label for="start_date">Start Date: </label>
	<input type="text" name="start_date" id="start_date" value="${start_date}"/>
	<label for="end_date">End Date: </label>
	<input type="text" name="end_date" id="end_date" value="${end_date}"/>
	<label for="resolution">Resolution: </label>
	<input type="text" name="resolution" id="resolution" value="${resolution}"/>
	<input type="submit" value="Update Chart"/>
</form>
</div>

<script type = "text/javascript">
YAHOO.widget.Chart.SWFURL = "http://yui.yahooapis.com/2.5.2/build/charts/assets/charts.swf";

var mychartdata = 
[
<py:for each="t in ticket_data">
  { date: "${t['date']}", new_tickets: ${t['new']}, closed: ${t['closed']}, open: ${t['open']} },
</py:for>
];

var myDataSource = new YAHOO.util.DataSource( mychartdata );
myDataSource.responseType = YAHOO.util.DataSource.TYPE_JSARRAY;
myDataSource.responseSchema =
{
	fields: [ "date", "new_tickets", "open", "closed" ]
};

var seriesDef =
[
	{ displayName: "New Tickets", yField: "new_tickets", style: {color: 0xff0000, size: 40} },
	{ displayName: "Closed Tickets", yField: "closed", style: {color: 0x00ff00, size:40} },
	{ type: "line", displayName: "Open Tickets", yField: "open", style: {color: 0x0000ff} }
];

var numtixAxis = new YAHOO.widget.NumericAxis();
numtixAxis.minimum = 0

YAHOO.example.getDataTipText = function( item, index, series )
{
	var toolTipText = series.displayName + " for " + item.date;
	toolTipText += "\n" + item[series.yField] ;
	return toolTipText;
}

var mychart = new YAHOO.widget.ColumnChart( "chart", myDataSource,
{
	xField: "date",
	series: seriesDef,
	yAxis: numtixAxis,
	dataTipFunction: YAHOO.example.getDataTipText,
	style: {legend: {display: "bottom"}}
});


</script>

  </body>
</html>
