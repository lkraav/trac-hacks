<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:xi="http://www.w3.org/2001/XInclude"
      xmlns:py="http://genshi.edgewall.org/"
      xmlns:i18n="http://genshi.edgewall.org/i18n"
      i18n:domain="watchlist"
      py:strip="">

  <div id="tickets">
        <py:choose test="">
          <div class="system-message" py:when="'TICKET_VIEW' not in perm">
          <h2>${get_label(realm,1000)}</h2>
            You lack permission to view tickets.
          </div>
          <div class="ticketlist-main" id="ticketlist-main" py:otherwise="">
            <div>
            <h2 class="${ticketlist and 'foldable' or ''}">${get_label(realm,1000)}</h2>
            <div class="watchlist-parent" id="ticketlist-parent" py:if="ticketlist">
            <table class="watchlist" id="ticketlist"
                   py:with="attr = {
                    'unwatch': { 'class':'unwatch sorting_disabled' },
                    'notify': { 'class':'notify sorting_disabled' },
                  }">
              <thead>
                <tr>
                  <th py:for="k in active_columns[realm]"
                      py:if="k != 'notify' or notifications"
                      class="${k}" py:attrs="attr.get(k,{})">${available_columns[realm][k]}</th>
                </tr>
              </thead>
              <tbody>
                  <td py:def="ticket_id" class="id">
                    <a href="${href('ticket', ticket.id)}"
                        title="${ticket.type}: ${ticket.summary} (${ticket.status}${ticket.status == 'closed' and ': ' + ticket.resolution or ''})"
                      class="${ticket.status == 'closed' and 'closed'}">#${ticket.id}</a>
                  </td>
                  <td py:def="ticket_changetime" class="changetime">
                        <span class="itime">$ticket.ichangetime</span>$ticket.changetime
                        ${print_timedelta(ticket.changetime_delta, ticket.changetime_link)}
                  </td>
                  <td py:def="ticket_time" class="time">
                        <span class="itime">$ticket.itime</span>$ticket.time
                        ${print_timedelta(ticket.time_delta, ticket.time_link)}
                  </td>
                  <td py:def="ticket_commentnum" class="commentnum"><a href="${href('ticket',ticket.id)
                      + ((ticket.commentnum != '0') and ('#comment:'
                      + ticket.commentnum) or
                      '')}">$ticket.commentnum</a></td>
                  <td py:def="ticket_unwatch" class="unwatch"><a class="plainlink"
                      href="${href.watchlist(action='unwatch',realm='ticket',
                      resid=ticket.id)}">${unwatchicon()}</a></td>
                  <td py:def="ticket_notify" class="notify" py:if="notifications">
                      ${notifybox('ticket',ticket.id,ticket.notify)}</td>
                  <td py:def="ticket_generic" class="${k}">${ticket.get(k,'')}</td>
                <tr py:for="ticket in ticketlist">
                  <py:for each="k in active_columns[realm]">
                      ${value_of('ticket_' + k,ticket_generic)()}
                  </py:for>
                </tr>
              </tbody>
              <tfoot py:if="settings['dynamic_tables'] and settings['individual_column_filtering']">
                <tr>
                  <th py:for="k in active_columns[realm]"
                      py:if="k != 'notify' or notifications"
                      class="${k}">
                      <input py:if="k not in attr" name="${k}" type="text" size="4" />
                  </th>
                </tr>
              </tfoot>
            </table>
          </div>
          <p class="noentrymessage" style="${ticketlist or 'display:block'}">
            No tickets are currently watched.
          </p>
          </div>
          ${modify_form('ticket')}
          </div>
        </py:choose>
  </div>
</html>
